{
	"info": {
		"_postman_id": "dmr-api-collection",
		"name": "DMR API Collection",
		"description": "DMR医疗记录系统API测试集合",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"variable": [
		{
			"key": "baseUrl",
			"value": "http://localhost:8000",
			"type": "string"
		},
		{
			"key": "token",
			"value": "",
			"type": "string"
		}
	],
	"auth": {
		"type": "bearer",
		"bearer": [
			{
				"key": "token",
				"value": "{{token}}",
				"type": "string"
			}
		]
	},
	"item": [
		{
			"name": "Authentication",
			"item": [
				{
					"name": "Login (Token Auth)",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"// 自动保存token到环境变量",
									"if (pm.response.code === 200) {",
									"    const responseJson = pm.response.json();",
									"    if (responseJson.token) {",
									"        pm.collectionVariables.set('token', responseJson.token);",
									"        console.log('Token saved:', responseJson.token);",
									"    }",
									"}"
								],
								"type": "text/javascript"
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"your_username\",\n    \"password\": \"your_password\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api-auth/login/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api-auth",
								"login",
								""
							]
						},
						"description": "获取认证token"
					}
				}
			]
		},
		{
			"name": "Patients API",
			"item": [
				{
					"name": "List Patients",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/patients/patients/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"patients",
								"patients",
								""
							],
							"query": [
								{
									"key": "page",
									"value": "1",
									"disabled": true
								}
							]
						},
						"description": "获取患者列表"
					}
				},
				{
					"name": "Create Patient",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"first_name\": \"张\",\n    \"last_name\": \"三\",\n    \"date_of_birth\": \"1990-01-01\",\n    \"email\": \"zhangsan@example.com\",\n    \"phone_number\": \"13800138000\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/patients/patients/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"patients",
								"patients",
								""
							]
						},
						"description": "创建新患者"
					}
				},
				{
					"name": "Get Patient Detail",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/patients/patients/{{patient_id}}/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"patients",
								"patients",
								"{{patient_id}}",
								""
							]
						},
						"description": "获取患者详情"
					}
				},
				{
					"name": "Update Patient",
					"request": {
						"method": "PUT",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"first_name\": \"张\",\n    \"last_name\": \"三\",\n    \"date_of_birth\": \"1990-01-01\",\n    \"email\": \"zhangsan@example.com\",\n    \"phone_number\": \"13800138001\"\n}"
						},
						"url": {
							"raw": "{{baseUrl}}/api/patients/patients/{{patient_id}}/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"patients",
								"patients",
								"{{patient_id}}",
								""
							]
						},
						"description": "更新患者信息"
					}
				},
				{
					"name": "Delete Patient",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/patients/patients/{{patient_id}}/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"patients",
								"patients",
								"{{patient_id}}",
								""
							]
						},
						"description": "删除患者"
					}
				},
				{
					"name": "Upload File",
					"request": {
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"type": "file",
									"src": []
								},
								{
									"key": "display_name",
									"value": "测试文件.pdf",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{baseUrl}}/api/patients/patients/{{patient_id}}/upload_file/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"patients",
								"patients",
								"{{patient_id}}",
								"upload_file",
								""
							]
						},
						"description": "上传患者文件"
					}
				},
				{
					"name": "List Patient Files",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/patients/patients/{{patient_id}}/files/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"patients",
								"patients",
								"{{patient_id}}",
								"files",
								""
							]
						},
						"description": "获取患者文件列表"
					}
				},
				{
					"name": "Get File Detail",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/patients/patients/{{patient_id}}/files/{{file_id}}/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"patients",
								"patients",
								"{{patient_id}}",
								"files",
								"{{file_id}}",
								""
							]
						},
						"description": "获取文件详情"
					}
				},
				{
					"name": "Delete File",
					"request": {
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/api/patients/patients/{{patient_id}}/files/{{file_id}}/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"api",
								"patients",
								"patients",
								"{{patient_id}}",
								"files",
								"{{file_id}}",
								""
							]
						},
						"description": "删除文件"
					}
				}
			]
		},
		{
			"name": "Student Groups API",
			"item": [
				{
					"name": "Notes",
					"item": [
						{
							"name": "List Notes",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/notes/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"notes",
										""
									]
								},
								"description": "获取笔记列表"
							}
						},
						{
							"name": "Create Note",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"patient\": 1,\n    \"user\": 1,\n    \"content\": \"患者状态良好，建议继续观察。\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/notes/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"notes",
										""
									]
								},
								"description": "创建新笔记"
							}
						},
						{
							"name": "Get Note Detail",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/notes/{{note_id}}/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"notes",
										"{{note_id}}",
										""
									]
								},
								"description": "获取笔记详情"
							}
						},
						{
							"name": "Update Note",
							"request": {
								"method": "PUT",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"patient\": 1,\n    \"user\": 1,\n    \"content\": \"患者状态稳定，血压正常。\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/notes/{{note_id}}/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"notes",
										"{{note_id}}",
										""
									]
								},
								"description": "更新笔记"
							}
						},
						{
							"name": "Delete Note",
							"request": {
								"method": "DELETE",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/notes/{{note_id}}/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"notes",
										"{{note_id}}",
										""
									]
								},
								"description": "删除笔记"
							}
						}
					]
				},
				{
					"name": "Observations",
					"item": [
						{
							"name": "Create Multiple Observations",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"blood_pressure\": {\n        \"patient\": 1,\n        \"user\": 1,\n        \"systolic\": 120,\n        \"diastolic\": 80\n    },\n    \"heart_rate\": {\n        \"patient\": 1,\n        \"user\": 1,\n        \"heart_rate\": 72\n    },\n    \"body_temperature\": {\n        \"patient\": 1,\n        \"user\": 1,\n        \"temperature\": \"36.5\"\n    }\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/observations/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"observations",
										""
									]
								},
								"description": "批量创建观察记录"
							}
						},
						{
							"name": "Create Blood Pressure Only",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"blood_pressure\": {\n        \"patient\": 1,\n        \"user\": 1,\n        \"systolic\": 130,\n        \"diastolic\": 85\n    }\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/observations/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"observations",
										""
									]
								},
								"description": "仅创建血压记录"
							}
						},
						{
							"name": "Get Observations by User and Patient",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/observations/?user=1&patient=1",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"observations",
										""
									],
									"query": [
										{
											"key": "user",
											"value": "1"
										},
										{
											"key": "patient",
											"value": "1"
										}
									]
								},
								"description": "根据用户和患者ID获取观察记录"
							}
						}
					]
				},
				{
					"name": "Blood Pressure",
					"item": [
						{
							"name": "List Blood Pressures",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/observations/blood-pressures/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"observations",
										"blood-pressures",
										""
									]
								},
								"description": "获取血压记录列表"
							}
						},
						{
							"name": "Create Blood Pressure",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"patient\": 1,\n    \"user\": 1,\n    \"systolic\": 120,\n    \"diastolic\": 80\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/observations/blood-pressures/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"observations",
										"blood-pressures",
										""
									]
								},
								"description": "创建血压记录"
							}
						},
						{
							"name": "Get Blood Pressure Detail",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/observations/blood-pressures/{{bp_id}}/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"observations",
										"blood-pressures",
										"{{bp_id}}",
										""
									]
								},
								"description": "获取血压记录详情"
							}
						}
					]
				},
				{
					"name": "Heart Rate",
					"item": [
						{
							"name": "List Heart Rates",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/observations/heart-rates/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"observations",
										"heart-rates",
										""
									]
								},
								"description": "获取心率记录列表"
							}
						},
						{
							"name": "Create Heart Rate",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"patient\": 1,\n    \"user\": 1,\n    \"heart_rate\": 72\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/observations/heart-rates/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"observations",
										"heart-rates",
										""
									]
								},
								"description": "创建心率记录"
							}
						}
					]
				},
				{
					"name": "Body Temperature",
					"item": [
						{
							"name": "List Body Temperatures",
							"request": {
								"method": "GET",
								"header": [],
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/observations/body-temperatures/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"observations",
										"body-temperatures",
										""
									]
								},
								"description": "获取体温记录列表"
							}
						},
						{
							"name": "Create Body Temperature",
							"request": {
								"method": "POST",
								"header": [
									{
										"key": "Content-Type",
										"value": "application/json"
									}
								],
								"body": {
									"mode": "raw",
									"raw": "{\n    \"patient\": 1,\n    \"user\": 1,\n    \"temperature\": \"36.5\"\n}"
								},
								"url": {
									"raw": "{{baseUrl}}/api/student-groups/observations/body-temperatures/",
									"host": [
										"{{baseUrl}}"
									],
									"path": [
										"api",
										"student-groups",
										"observations",
										"body-temperatures",
										""
									]
								},
								"description": "创建体温记录"
							}
						}
					]
				}
			]
		},
		{
			"name": "API Schema & Documentation",
			"item": [
				{
					"name": "Get OpenAPI Schema",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Accept",
								"value": "application/json"
							}
						],
						"url": {
							"raw": "{{baseUrl}}/schema/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"schema",
								""
							]
						},
						"description": "获取OpenAPI schema定义"
					}
				},
				{
					"name": "Swagger UI",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{baseUrl}}/schema/swagger-ui/",
							"host": [
								"{{baseUrl}}"
							],
							"path": [
								"schema",
								"swagger-ui",
								""
							]
						},
						"description": "访问Swagger UI文档界面"
					}
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// 全局预请求脚本",
					"console.log('Request URL:', pm.request.url.toString());",
					"console.log('Request Method:', pm.request.method);",
					"",
					"// 如果有token，自动添加到Authorization header",
					"const token = pm.collectionVariables.get('token');",
					"if (token && !pm.request.headers.has('Authorization')) {",
					"    pm.request.headers.add({",
					"        key: 'Authorization',",
					"        value: 'Bearer ' + token",
					"    });",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"exec": [
					"// 全局测试脚本",
					"console.log('Response Status:', pm.response.code);",
					"console.log('Response Time:', pm.response.responseTime + 'ms');",
					"",
					"// 检查常见的响应状态",
					"if (pm.response.code >= 400) {",
					"    console.log('Error Response:', pm.response.text());",
					"}",
					"",
					"// 验证JSON响应格式",
					"if (pm.response.headers.get('Content-Type').includes('application/json')) {",
					"    try {",
					"        const jsonData = pm.response.json();",
					"        console.log('Response Data:', jsonData);",
					"    } catch (e) {",
					"        console.log('Invalid JSON response');",
					"    }",
					"}"
				]
			}
		}
	]
}
